RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$Sv..x <- cutDownData$Sv..x/100
cutDownData$Sv..y <- cutDownData$Sv..y*100
RMSE(cutDownData$Sv..x, cutDownData$Sv..y)
RMSE(cutDownData$JS, cutDownData$Sv..y)
cutDownData
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 200)
subSplisubSplit <- subset(subSplit, SA <= 300)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/234
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$Sv..x <- cutDownData$Sv..x/100
cutDownData$Sv..y <- cutDownData$Sv..y/100
RMSE(cutDownData$Sv..x, cutDownData$Sv..y)
RMSE(cutDownData$JS, cutDownData$Sv..y)
c
cutDownData
RMSE(p.bar, cutDownData$Sv..y)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 300)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/234
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$Sv..x <- cutDownData$Sv..x/100
cutDownData$Sv..y <- cutDownData$Sv..y/100
RMSE(cutDownData$Sv..x, cutDownData$Sv..y)
RMSE(cutDownData$JS, cutDownData$Sv..y)
RMSE(p.bar, cutDownData$Sv..y)
cutDownData
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/234
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$Sv..x <- cutDownData$Sv..x/100
cutDownData$Sv..y <- cutDownData$Sv..y/100
RMSE(cutDownData$Sv..x, cutDownData$Sv..y)
RMSE(cutDownData$JS, cutDownData$Sv..y)
RMSE(p.bar, cutDownData$Sv..y)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/275
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$Sv..x <- cutDownData$Sv..x/100
cutDownData$Sv..y <- cutDownData$Sv..y/100
RMSE(cutDownData$Sv..x, cutDownData$Sv..y)
RMSE(cutDownData$JS, cutDownData$Sv..y)
RMSE(p.bar, cutDownData$Sv..y)
splitStats <- read.csv("GoalieSplit.csv")
gameStats <- read.csv("GamebyGame.csv")
seasonStats <- read.csv("GoalieSeason.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/200
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$Sv..x <- cutDownData$Sv..x/100
cutDownData$Sv..y <- cutDownData$Sv..y/100
RMSE(cutDownData$Sv..x, cutDownData$Sv..y)
RMSE(cutDownData$JS, cutDownData$Sv..y)
RMSE(p.bar, cutDownData$Sv..y)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
seasonSplit <- subset(seasonStats, GP >= 45)
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/100
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$Sv..x <- cutDownData$Sv..x/100
cutDownData$Sv..y <- cutDownData$Sv..y/100
RMSE(cutDownData$Sv..x, cutDownData$Sv..y)
RMSE(cutDownData$JS, cutDownData$Sv..y)
RMSE(p.bar, cutDownData$SvP.y)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
seasonSplit <- subset(seasonStats, GP >= 45)
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/100
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
sig.squared <- p.bar*(1 - p.bar)/200
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
mean(cutDownData$SA.x)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/225
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
plot(cutDownData$SA.x)
plot(cutDownData$GA.x,cutDownData$SA.x)
plot(cutDownData$GA.x,cutDownData$GA.y)
plot(cutDownData$SV..x,cutDownData$SV..y)
plot(cutDownData$SV..x,cutDownData$SV..y)
cutDownData
plot(cutDownData$SV..x,cutDownData$SV..y)
plot(cutDownData$SV..x,cutDownData$SV..y,xlim =1)
plot(cutDownData$SV..x,cutDownData$SV..y,minx = .85, maxx= 1)
plot(cutDownData$SV..x,cutDownData$SV..y,min(x) = .85, max(x) = 1)
plot(cutDownData$SV..x*100,cutDownData$SV..y*100)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/225
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/234.2
sig.squared
c <- 1 - (k-3)*sig.squared/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
cutDownData
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
subSplit <- subset(splitStats, SA >= 200)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/234.2
sig.squared
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/234.2
sig.squared
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
subSplit <- subset(splitStats, SA >= 150)
subSplit
splitStats <- read.csv("GoalieSplit.csv")
splitStats
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/234.2
sig.squared
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nr=2), beside = TRUE, names.arg = cutDownData$Player)
counts <- table(cutDownData$JSMS, cutDownData$SMMS)
counts <- counts[!is.na[counts]]
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nr=2), beside = TRUE, names.arg = cutDownData$Player)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/cutDownData$SA.x
sig.squared
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
cutDownData$SMMS <- mapply(RMSE,cutDownData$SvP.x, cutDownData$SvP.y)
cutDownData$JSMS <- mapply(RMSE,cutDownData$JS, cutDownData$SvP.y)
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
counts <- table(cutDownData$JSMS, cutDownData$SMMS)
counts <- counts[!is.na[counts]]
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nr=2), beside = TRUE, names.arg = cutDownData$Player)
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nr=2), beside = TRUE,space = 5, names.arg = cutDownData$Player)
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nr=2), beside = TRUE,space = 2, names.arg = cutDownData$Player)
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nr=2), beside = TRUE,space = 1, names.arg = cutDownData$Player)
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nr=2), beside = TRUE,space = 1, names.arg = cutDownData$Player)
barplot(matrix(c(cutDownData$JSMS, cutDownData$SMMS), nc=2), beside = TRUE,space = 1, names.arg = cutDownData$Player)
barplot(cutDownData$JS, beside = TRUE,space = 1, names.arg = cutDownData$Player)
splitStats <- read.csv("GoalieSplit.csv")
seasonStats <- read.csv("GoalieSeason.csv")
gameStats <- read.csv("GamebyGame.csv")
subSplit <- subset(splitStats, SA >= 150)
subSplisubSplit <- subset(subSplit, SA <= 350)
seasonSplit <- subset(seasonStats, GP >= 45)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/cutDownData$SA.x
sig.squared
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
cutDownData$SMMS <- mapply(RMSE,cutDownData$SvP.x, cutDownData$SvP.y)
cutDownData$JSMS <- mapply(RMSE,cutDownData$JS, cutDownData$SvP.y)
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
seasonSplit <- subset(seasonStats, GP >= 50)
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
mergedData <- merge(subSplit,seasonSplit, by = "Player")
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
sig.squared <- p.bar*(1 - p.bar)/cutDownData$SA.x
c
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
cutDownData$SMMS <- mapply(RMSE,cutDownData$SvP.x, cutDownData$SvP.y)
cutDownData$JSMS <- mapply(RMSE,cutDownData$JS, cutDownData$SvP.y)
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
seasonSplit <- subset(seasonStats, GP >= 40)
mergedData <- merge(subSplit,seasonSplit, by = "Player")
# t <- merge(What, gameStats, by = "Player")
cutDownData <- subset(mergedData, select=c("Player", "GA.x", "SA.x", "GA.y", "SA.y", "Sv..x", "Sv..y"))
k <- nrow(cutDownData)
p.bar <- 1 - mean(cutDownData$GA.x)/mean(cutDownData$SA.x)
p.bar
p.hat <- cutDownData$Sv..x/100
p.hat
ss.p.bar <- sum((p.hat - p.bar)^2)
ss.p.bar
sig.squared <- p.bar*(1 - p.bar)/cutDownData$SA.x
sig.squared
c <- 1 - (k-3)*(p.bar*(1 - p.bar)/cutDownData$SA.x)/sum((p.hat - p.bar)^2)
cutDownData$JS <- p.bar + c*(p.hat - p.bar)
c
RMSE <- function(x, y){sqrt(mean((x-y)^2))}
cutDownData$SvP.x <- cutDownData$Sv..x/100
cutDownData$SvP.y <- cutDownData$Sv..y/100
cutDownData$SMMS <- mapply(RMSE,cutDownData$SvP.x, cutDownData$SvP.y)
cutDownData$JSMS <- mapply(RMSE,cutDownData$JS, cutDownData$SvP.y)
RMSE(cutDownData$SvP.x, cutDownData$SvP.y)
RMSE(cutDownData$JS, cutDownData$SvP.y)
RMSE(p.bar, cutDownData$SvP.y)
cutDownData
